<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Location-based AR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>
<body>
    <a-scene embedded arjs="sourceType: webcam;">

        <!-- AR marker representing the object -->
        <a-marker type="location-based" latitude="32.665640" longitude="96.991880">
            <!-- Your 3D model or object -->
            <a-ring position="0 0.5 0" radius-inner="0.5" radius-outer="0.7" material="color: #4CC3D9;"></a-ring>
        </a-marker>

        <!-- Camera for AR experience -->
        <a-entity camera gps-camera></a-entity>
    </a-scene>
    <!-- Add this div after the AR scene in the HTML file -->
<div id="distance-info" style="position: fixed; top: 10px; left: 10px; color: white;"></div>

    <!-- Add this script tag after including the libraries in the HTML file -->
<script>
    AFRAME.registerComponent('location-based', {
        init: function () {
            // Get latitude and longitude from the marker
            const latitude = parseFloat(this.el.getAttribute('latitude'));
            const longitude = parseFloat(this.el.getAttribute('longitude'));

            // Update the distance on every tick
            this.el.sceneEl.addEventListener('tick', () => {
                // Get current geolocation
                navigator.geolocation.getCurrentPosition(position => {
                    const userLatitude = position.coords.latitude;
                    const userLongitude = position.coords.longitude;

                    // Calculate the distance between user and marker (rough approximation)
                    const distance = calculateDistance(userLatitude, userLongitude, latitude, longitude);

                    // Update the HTML content with the distance
                    document.getElementById('distance-info').innerText = `Distance: ${distance.toFixed(2)} meters`;
                });
            });
        }
    });

    // Helper function to calculate distance between two coordinates
    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371; // Earth radius in kilometers
        const dLat = deg2rad(lat2 - lat1);
        const dLon = deg2rad(lon2 - lon1);
        const a =
            Math.sin(dLat / 2) * Math.sin(dLat / 2) +
            Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
            Math.sin(dLon / 2) * Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        const distance = R * c * 1000; // Distance in meters
        return distance;
    }

    // Helper function to convert degrees to radians
    function deg2rad(deg) {
        return deg * (Math.PI / 180);
    }
</script>

</body>
</html>
